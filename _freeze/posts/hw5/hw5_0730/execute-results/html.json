{
  "hash": "30347abeb192746b5754bab05c426d0e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"hw5\"\nformat: html\njupyter: python3\n---\n\n::: {#52e0f7f0 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n```\n:::\n\n\n::: {#57606ca5 .cell execution_count=2}\n``` {.python .cell-code}\nimport pyreadstat\n```\n:::\n\n\n::: {#c18c386b .cell execution_count=3}\n``` {.python .cell-code}\nraw_welfare = pd.read_spss(\"C:/Users/USER/Documents/LS빅데이터스쿨/lsbigdata-project1/data/koweps/Koweps_hpwc14_2019_beta2.sav\")\nraw_welfare \n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>h14_id</th>\n      <th>h14_ind</th>\n      <th>h14_sn</th>\n      <th>h14_merkey</th>\n      <th>h_new</th>\n      <th>h14_cobf</th>\n      <th>p14_wsc</th>\n      <th>p14_wsl</th>\n      <th>p14_wgc</th>\n      <th>p14_wgl</th>\n      <th>...</th>\n      <th>wc14_64</th>\n      <th>wc14_65</th>\n      <th>wc14_5aq4</th>\n      <th>wc14_5aq5</th>\n      <th>wc14_5aq6</th>\n      <th>h14_pers_income1</th>\n      <th>h14_pers_income2</th>\n      <th>h14_pers_income3</th>\n      <th>h14_pers_income4</th>\n      <th>h14_pers_income5</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>20101.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>0.291589</td>\n      <td>0.291589</td>\n      <td>1307.764781</td>\n      <td>1307.764781</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>30101.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>0.419753</td>\n      <td>0.419753</td>\n      <td>1882.570960</td>\n      <td>1882.570960</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>4.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>40101.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>0.265263</td>\n      <td>0.265980</td>\n      <td>1189.691668</td>\n      <td>1192.908537</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1284.0</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>6.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>60101.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>0.494906</td>\n      <td>0.495941</td>\n      <td>2219.630833</td>\n      <td>2224.273816</td>\n      <td>...</td>\n      <td>1.0</td>\n      <td>.</td>\n      <td>2.0</td>\n      <td>4.0</td>\n      <td>4.0</td>\n      <td>2304.0</td>\n      <td>NaN</td>\n      <td>1800.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>6.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>60101.0</td>\n      <td>0.0</td>\n      <td>NaN</td>\n      <td>1.017935</td>\n      <td>1.017935</td>\n      <td>4565.389177</td>\n      <td>4565.389177</td>\n      <td>...</td>\n      <td>1.0</td>\n      <td>.</td>\n      <td>1.0</td>\n      <td>5.0</td>\n      <td>2.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>14413</th>\n      <td>9800.0</td>\n      <td>7.0</td>\n      <td>1.0</td>\n      <td>98000701.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14414</th>\n      <td>9800.0</td>\n      <td>7.0</td>\n      <td>1.0</td>\n      <td>98000701.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14415</th>\n      <td>9800.0</td>\n      <td>7.0</td>\n      <td>1.0</td>\n      <td>98000701.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>208.0</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14416</th>\n      <td>9800.0</td>\n      <td>7.0</td>\n      <td>1.0</td>\n      <td>98000701.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>5.0</td>\n      <td>.</td>\n      <td>4.0</td>\n      <td>3.0</td>\n      <td>3.0</td>\n      <td>NaN</td>\n      <td>1200.0</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>14417</th>\n      <td>9800.0</td>\n      <td>7.0</td>\n      <td>1.0</td>\n      <td>98000701.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td></td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.0</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>14418 rows × 830 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#c434de54 .cell execution_count=4}\n``` {.python .cell-code}\nwelfare = raw_welfare.copy()\nwelfare.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n(14418, 830)\n```\n:::\n:::\n\n\n::: {#aac4c7b0 .cell execution_count=5}\n``` {.python .cell-code}\nwelfare = welfare.rename(\n  columns = {\n             'h14_g3' : 'sex',  #성별\n             'h14_g4' : 'birth',  # 태어난 연도 \n             'h14_g10' : 'marriage_type',  #혼인상태\n             'h14_g11' : 'religion',  # 종교\n             'p1402_8aq1' : 'income',  # 월급\n             'h14_eco9' : 'code_job',  # 직업코드\n             'h14_reg7' : 'code_region'  #지역코드\n})\n\nwelfare = welfare[['sex', 'birth', 'marriage_type', 'religion','income', 'code_job','code_region']]\nwelfare\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>birth</th>\n      <th>marriage_type</th>\n      <th>religion</th>\n      <th>income</th>\n      <th>code_job</th>\n      <th>code_region</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2.0</td>\n      <td>1945.0</td>\n      <td>2.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1.0</td>\n      <td>1948.0</td>\n      <td>2.0</td>\n      <td>2.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1.0</td>\n      <td>1942.0</td>\n      <td>3.0</td>\n      <td>1.0</td>\n      <td>107.0</td>\n      <td>762.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.0</td>\n      <td>1962.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>192.0</td>\n      <td>855.0</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2.0</td>\n      <td>1963.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>14413</th>\n      <td>2.0</td>\n      <td>1967.0</td>\n      <td>1.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>14414</th>\n      <td>2.0</td>\n      <td>1992.0</td>\n      <td>5.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>14415</th>\n      <td>1.0</td>\n      <td>1995.0</td>\n      <td>5.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>910.0</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>14416</th>\n      <td>2.0</td>\n      <td>1998.0</td>\n      <td>5.0</td>\n      <td>1.0</td>\n      <td>200.0</td>\n      <td>246.0</td>\n      <td>5.0</td>\n    </tr>\n    <tr>\n      <th>14417</th>\n      <td>1.0</td>\n      <td>2001.0</td>\n      <td>0.0</td>\n      <td>1.0</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>5.0</td>\n    </tr>\n  </tbody>\n</table>\n<p>14418 rows × 7 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#d3f2d82f .cell execution_count=6}\n``` {.python .cell-code}\nwelfare[\"sex\"].dtypes\nwelfare[\"sex\"].value_counts()\nwelfare[\"sex\"].isna().sum()\n\nwelfare[\"sex\"] = np.where(welfare[\"sex\"] == 1, 'male', 'female')\nwelfare[\"sex\"].value_counts()\n\n\nwelfare[\"income\"].describe()\nwelfare[\"income\"].isna().sum()\n\nsex_income = welfare.dropna(subset = \"income\") \\\n       .groupby(\"sex\", as_index= False) \\\n       .agg(mean_income = (\"income\", \"mean\"))\nsex_income\n\nsns.barplot(data = sex_income, x = \"sex\", y=\"mean_income\", hue=\"sex\")\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_0730_files/figure-html/cell-7-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n## 표본분산, 표본평균, 표본크기\n\n::: {#2bc1b555 .cell execution_count=7}\n``` {.python .cell-code}\nsex_income = welfare.dropna(subset = \"income\") \\\n       .groupby(\"sex\", as_index= False) \\\n       .agg(std_income = (\"income\", \"std\"),\n            mean_income = (\"income\", \"mean\"),\n            count_income = (\"income\", \"count\"))\nsex_income\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>std_income</th>\n      <th>mean_income</th>\n      <th>count_income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>female</td>\n      <td>132.057402</td>\n      <td>186.293096</td>\n      <td>2245</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>male</td>\n      <td>217.862254</td>\n      <td>349.037571</td>\n      <td>2289</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## 신뢰구간\n\n::: {#728195e1 .cell execution_count=8}\n``` {.python .cell-code}\nfrom scipy.stats import norm\nz = norm.ppf(0.975)\nsex_income['ci_lower'] = sex_income[\"mean_income\"] - z * (sex_income[\"std_income\"] /  np.sqrt(sex_income['count_income']-1))\n\nsex_income['ci_upper'] = sex_income[\"mean_income\"] + z * (sex_income[\"std_income\"] /  np.sqrt(sex_income['count_income']-1))\n```\n:::\n\n\n## 시각화\n\n::: {#a9651877 .cell execution_count=9}\n``` {.python .cell-code}\nsns.barplot(data = sex_income, x = \"sex\", y=\"mean_income\", hue=\"sex\")\nplt.errorbar(x=sex_income['sex'], \n             y=sex_income['mean_income'], \n             yerr=[sex_income['mean_income'] - sex_income['ci_lower'],\n             sex_income['ci_upper'] - sex_income['mean_income']],\n             capsize=5, \n             color='black',\n             label='Income',\n             fmt=\"none\")\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_0730_files/figure-html/cell-10-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n::: {#f77528df .cell execution_count=10}\n``` {.python .cell-code}\nimport pyreadstat\nprint(pyreadstat.__version__)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n1.2.7\n```\n:::\n:::\n\n\n",
    "supporting": [
      "hw5_0730_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}